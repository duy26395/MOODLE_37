require.config({
    paths: {
        "kendo.all.min": "/local/newsvnr/js/kendo.all.min",
        "dttable": "/local/newsvnr//js/datatable.min",
    }
});
define(['jquery', 'kendo.all.min', 'core/config', 'core/notification', 'dttable', 'core/str'], function($, kendo, Config, Notification, dttable, Str) {

    return {
        
        orgmanager: function(){
            $('[data-region="orgmanager-page"] button').click(function(event) {
              $body = $('body');
              var param = event.target.id;
              var settings = {
                  // async: false,
                  type: 'GET',
                  data: {
                      section: param
                  },
                  processData: true,
                  contentType: "application/json"
              };
              var script = Config.wwwroot + '/local/newsvnr/ajax/orgdata.php';
              $body.addClass("loading");
              $.ajax(script, settings)
              .then(function(response) {
                  if (response.error) {
                      Notification.addNotification({
                          message: response.error,
                          type: "error"
                      });
                  } else {
                        var data = JSON.parse(response);
                        $('#showtable_data').html(data.header);
                        var table = $('#org_datatable').DataTable({
                            "dom": 'frtip',
                            "language": {
                              "emptyTable": "Không có dữ liệu trong bảng",
                              "zeroRecords": "Không tìm thấy dữ liệu phù hợp"
                        },
                        "scrollX": true,
                        });
                        //Thêm class ẩn hiện khi active hoặc inactive
                        table.rows().eq(0).each( function ( index ) {
                          var row = table.row(index);
                          var searchClass = $(row.node()).find('td a').hasClass('show-item');
                          if(searchClass == true) 
                            $(row.node()).addClass('dimmed_text');
                        });
                        $body.removeClass("loading");
                      }
                      return;
                  }).fail(Notification.exception);
            });
        }           
    };
});